"use strict";exports.id=2533,exports.ids=[2533],exports.modules={40644:(e,a,t)=>{t.d(a,{cn:()=>s,lV:()=>o,xG:()=>i});var n=t(55761),r=t(62386);function s(...e){return(0,r.m6)((0,n.W)(e))}function i(e){return new Intl.NumberFormat("pt-BR",{style:"currency",currency:"BRL"}).format(e)}function o(e){return e?e.normalize("NFD").replace(/[\u0300-\u036f]/g,"").toLowerCase().replace(/[^a-z0-9]+/g,"-").replace(/^-+|-+$/g,"").replace(/-{2,}/g,"-"):""}},63841:(e,a,t)=>{t.d(a,{Z:()=>r});var n=t(53524);let r=globalThis.prisma??new n.PrismaClient({log:["error"]})},58181:(e,a,t)=>{t.d(a,{JN:()=>g,Pz:()=>m,XX:()=>b,Ye:()=>p,_6:()=>w,kn:()=>f,uq:()=>c,vX:()=>u});var n=t(63841),r=t(40644);function s(e){return e&&e.toLowerCase().includes("prem")?"PREMIUM":"BASIC"}function i(e){return(e||"").replace(/\D/g,"")}function o(e){if(!e)return;if(e instanceof Date)return e;let a=new Date(e);return Number.isNaN(a.getTime())?void 0:a}async function d(e,a){return(await n.Z.barbershop.findMany({where:{cpfCnpj:{not:null},...a?{NOT:{id:a}}:{}},select:{id:!0,cpfCnpj:!0}})).find(a=>i(a.cpfCnpj??"")===e)}function l(e){return{id:e.id,name:e.name,legalName:e.legalName??void 0,cpfCnpj:e.cpfCnpj??void 0,email:e.email??void 0,phone:e.phone??void 0,description:e.description??void 0,ownerId:e.ownerId??void 0,plan:"PREMIUM"===e.plan?"Premium":"B\xe1sico",status:e.status,expiryDate:e.expiryDate?.toISOString(),address:e.addressJson??void 0,operatingHours:e.operatingHoursJson??void 0,logoUrl:e.logoUrl??void 0,whatsappStatus:e.whatsappStatus,qrCodeBase64:e.qrCodeBase64??void 0,bitsafiraInstanceId:e.bitsafiraInstanceId??void 0,bitSafiraToken:e.bitSafiraToken??void 0,whatsAppInstanceId:e.whatsAppInstanceId??void 0,messageTemplates:e.messageTemplates?.map(e=>({id:e.id,name:e.name,content:e.content,enabled:e.enabled,type:e.type,reminderHoursBefore:e.reminderHoursBefore??null}))||[],bitsafiraInstanceData:e.bitsafiraInstanceData??void 0,createdAt:e.createdAt?.toISOString()}}async function c(e){let a=e.id||crypto.randomUUID(),t=i(e.cpfCnpj),r=o(e.expiryDate);if(t&&await d(t))throw Error("CPF/CNPJ j\xe1 est\xe1 cadastrado para outra barbearia.");return l(await n.Z.barbershop.create({data:{id:a,name:e.name,legalName:e.legalName,cpfCnpj:t||e.cpfCnpj,email:e.email,phone:e.phone,description:e.description,ownerId:e.ownerId,plan:s(e.plan),status:e.status,expiryDate:r,addressJson:e.address?e.address:void 0,operatingHoursJson:e.operatingHours?e.operatingHours:void 0,logoUrl:e.logoUrl,whatsappStatus:e.whatsappStatus,qrCodeBase64:e.qrCodeBase64,bitsafiraInstanceId:e.bitsafiraInstanceId??void 0,bitSafiraToken:e.bitSafiraToken??void 0,whatsAppInstanceId:e.whatsAppInstanceId??void 0,bitsafiraInstanceData:e.bitsafiraInstanceData??void 0},include:{messageTemplates:!0}}))}async function p(e,a){let t=i(a.cpfCnpj);if(t&&await d(t,e))throw Error("CPF/CNPJ j\xe1 est\xe1 cadastrado para outra barbearia.");let r=o(a.expiryDate);return l(await n.Z.barbershop.update({where:{id:e},data:{name:a.name,legalName:a.legalName,cpfCnpj:t||a.cpfCnpj,email:a.email,phone:a.phone,description:a.description,ownerId:a.ownerId,plan:a.plan?s(a.plan):void 0,status:a.status,expiryDate:r,addressJson:a.address?a.address:void 0,operatingHoursJson:a.operatingHours?a.operatingHours:void 0,logoUrl:a.logoUrl,whatsappStatus:a.whatsappStatus,qrCodeBase64:a.qrCodeBase64,bitsafiraInstanceId:a.bitsafiraInstanceId,bitSafiraToken:a.bitSafiraToken,whatsAppInstanceId:a.whatsAppInstanceId,bitsafiraInstanceData:a.bitsafiraInstanceData},include:{messageTemplates:!0}}))}async function u(e){let a=await n.Z.barbershop.findUnique({where:{id:e},include:{messageTemplates:!0}});return a?l(a):null}async function f(e){let a=await u(e);if(a)return a;let t=(0,r.lV)(e||"");if(!t)return null;let s=(await n.Z.barbershop.findMany({include:{messageTemplates:!0}})).find(e=>(0,r.lV)(e.name)===t);return s?l(s):null}async function g(e){let a=await n.Z.barbershop.findFirst({where:{bitsafiraInstanceId:e},include:{messageTemplates:!0}});return a?l(a):null}async function m(){return(await n.Z.barbershop.findMany({orderBy:{createdAt:"desc"},include:{messageTemplates:!0}})).map(l)}async function b(e){return(await n.Z.barbershop.findMany({where:{ownerId:e},orderBy:{createdAt:"desc"},include:{messageTemplates:!0}})).map(l)}async function w(e){await n.Z.barbershop.delete({where:{id:e}})}},73824:(e,a,t)=>{t.d(a,{E:()=>r});var n=t(79109);function r(e,a){let t=(0,n.Q)(e);if(isNaN(a)){var r;return r=NaN,e instanceof Date?new e.constructor(r):new Date(r)}return a&&t.setDate(t.getDate()+a),t}},42046:(e,a,t)=>{t.d(a,{j:()=>i});var n=t(79109);function r(e){let a=(0,n.Q)(e);return a.setHours(0,0,0,0),a}function s(e){let a=(0,n.Q)(e),t=new Date(Date.UTC(a.getFullYear(),a.getMonth(),a.getDate(),a.getHours(),a.getMinutes(),a.getSeconds(),a.getMilliseconds()));return t.setUTCFullYear(a.getFullYear()),+e-+t}function i(e,a){let t=(0,n.Q)(e),i=(0,n.Q)(a),d=o(t,i),l=Math.abs(function(e,a){let t=r(e),n=r(a);return Math.round((+t-s(t)-(+n-s(n)))/864e5)}(t,i));t.setDate(t.getDate()-d*l);let c=Number(o(t,i)===-d),p=d*(l-c);return 0===p?0:p}function o(e,a){let t=e.getFullYear()-a.getFullYear()||e.getMonth()-a.getMonth()||e.getDate()-a.getDate()||e.getHours()-a.getHours()||e.getMinutes()-a.getMinutes()||e.getSeconds()-a.getSeconds()||e.getMilliseconds()-a.getMilliseconds();return t<0?-1:t>0?1:t}},79109:(e,a,t)=>{function n(e){let a=Object.prototype.toString.call(e);return e instanceof Date||"object"==typeof e&&"[object Date]"===a?new e.constructor(+e):new Date("number"==typeof e||"[object Number]"===a||"string"==typeof e||"[object String]"===a?e:NaN)}t.d(a,{Q:()=>n})}};
"use strict";(()=>{var e={};e.id=800,e.ids=[800],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},68400:(e,t,r)=>{r.r(t),r.d(t,{originalPathname:()=>g,patchFetch:()=>E,requestAsyncStorage:()=>m,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>y});var a={};r.r(a),r.d(a,{DELETE:()=>p,GET:()=>d,PATCH:()=>u});var i=r(49303),s=r(88716),n=r(60670),o=r(87070),c=r(30557);async function d(e,{params:t}){try{let e=await (0,c.PS)(t.id);return o.NextResponse.json({data:e})}catch(e){return console.error("GET /api/tickets/:id error:",e),o.NextResponse.json({error:"Erro ao buscar ticket"},{status:500})}}async function u(e,{params:t}){try{let r=await e.json(),a=await (0,c.O)(t.id,r);return o.NextResponse.json({data:a})}catch(e){return console.error("PATCH /api/tickets/:id error:",e),o.NextResponse.json({error:"Erro ao atualizar ticket"},{status:500})}}async function p(e,{params:t}){try{return await (0,c.M4)(t.id),o.NextResponse.json({success:!0})}catch(e){return console.error("DELETE /api/tickets/:id error:",e),o.NextResponse.json({error:"Erro ao excluir ticket"},{status:500})}}let l=new i.AppRouteRouteModule({definition:{kind:s.x.APP_ROUTE,page:"/api/tickets/[id]/route",pathname:"/api/tickets/[id]",filename:"route",bundlePath:"app/api/tickets/[id]/route"},resolvedPagePath:"/var/www/barberflow/src/app/api/tickets/[id]/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:m,staticGenerationAsyncStorage:y,serverHooks:h}=l,g="/api/tickets/[id]/route";function E(){return(0,n.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:y})}},63841:(e,t,r)=>{r.d(t,{Z:()=>i});var a=r(53524);let i=globalThis.prisma??new a.PrismaClient({log:["error"]})},30557:(e,t,r)=>{r.d(t,{M4:()=>u,O:()=>d,PS:()=>l,XN:()=>o,ax:()=>c,u2:()=>p});var a=r(63841);function i(e){switch(e){case"in_progress":return"IN_PROGRESS";case"closed":return"CLOSED";default:return"OPEN"}}function s(e){return{id:e.id,title:e.subject,description:e.message??"",status:"CLOSED"===e.status?"closed":"IN_PROGRESS"===e.status?"in_progress":"open",priority:e.priority||"medium",category:e.category||"other",createdBy:e.createdByUserId??"",createdAt:e.createdAt,updatedAt:e.updatedAt,assignedTo:void 0,barbershopId:e.barbershopId??void 0,clientEmail:e.clientEmail??"",clientName:e.clientName??""}}function n(e){return{id:e.id,message:e.message,createdBy:e.authorUserId??"",createdAt:e.createdAt,isAdmin:!!e.isAdmin}}async function o(e){return(await a.Z.ticket.findMany({where:e?{barbershopId:e}:void 0,orderBy:{createdAt:"desc"}})).map(s)}async function c(e){return s(await a.Z.ticket.create({data:{barbershopId:e.barbershopId,subject:e.title,message:e.description,status:i(e.status),priority:e.priority,category:e.category,createdByUserId:e.createdBy,clientEmail:e.clientEmail,clientName:e.clientName}}))}async function d(e,t){return s(await a.Z.ticket.update({where:{id:e},data:{subject:t.title,message:t.description,status:t.status?i(t.status):void 0,priority:t.priority,category:t.category,clientEmail:t.clientEmail,clientName:t.clientName,barbershopId:t.barbershopId}}))}async function u(e){await a.Z.ticket.delete({where:{id:e}})}async function p(e){return n(await a.Z.ticketResponse.create({data:{ticketId:e.ticketId,message:e.message,authorUserId:e.createdBy,isAdmin:e.isAdmin}}))}async function l(e){return(await a.Z.ticketResponse.findMany({where:{ticketId:e},orderBy:{createdAt:"asc"}})).map(n)}}};var t=require("../../../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),a=t.X(0,[8948,5972],()=>r(68400));module.exports=a})();
"use strict";(()=>{var e={};e.id=6879,e.ids=[6879],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},23683:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>b,patchFetch:()=>y,requestAsyncStorage:()=>l,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>x});var a={};t.r(a),t.d(a,{GET:()=>u,POST:()=>d});var s=t(49303),n=t(88716),o=t(60670),i=t(87070),p=t(52801);async function u(e){try{let{searchParams:r}=new URL(e.url),t=r.get("barbershopId");if(!t)return i.NextResponse.json({error:"barbershopId ? obrigat?rio"},{status:400});let a=await (0,p.OW)(t);return i.NextResponse.json({data:a})}catch(e){return console.error("GET /api/expenses error:",e),i.NextResponse.json({error:"Erro ao listar despesas"},{status:500})}}async function d(e){try{let{barbershopId:r,description:t,category:a,type:s,amount:n,date:o}=await e.json()??{};if(!r)return i.NextResponse.json({error:"barbershopId ? obrigat?rio"},{status:400});if(!t||!a||!s||!n||!o)return i.NextResponse.json({error:"Campos obrigat\xf3rios ausentes"},{status:400});let u=Number(n);if(!Number.isFinite(u))return i.NextResponse.json({error:"Valor inv\xe1lido para a despesa"},{status:400});let d=new Date(o);if(Number.isNaN(d.getTime()))return i.NextResponse.json({error:"Data inv\xe1lida para a despesa"},{status:400});let c=await (0,p.Fl)({barbershopId:r,description:t,category:a,type:s,amount:u,date:d});return i.NextResponse.json({data:c},{status:201})}catch(e){return console.error("POST /api/expenses error:",e),i.NextResponse.json({error:"Erro ao criar despesa"},{status:500})}}let c=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/expenses/route",pathname:"/api/expenses",filename:"route",bundlePath:"app/api/expenses/route"},resolvedPagePath:"/var/www/barberflow/src/app/api/expenses/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:l,staticGenerationAsyncStorage:x,serverHooks:m}=c,b="/api/expenses/route";function y(){return(0,o.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:x})}},63841:(e,r,t)=>{t.d(r,{Z:()=>s});var a=t(53524);let s=globalThis.prisma??new a.PrismaClient({log:["error"]})},52801:(e,r,t)=>{t.d(r,{E:()=>u,Fl:()=>p,OW:()=>i,vu:()=>d});var a=t(53524),s=t(84770),n=t(63841);function o(e){return{id:e.id,barbershopId:e.barbershopId,description:e.description??"",category:e.category||"Outros",type:e.expenseType||"Vari\xe1vel",amount:Number(e.amount),date:e.expenseDate}}async function i(e){return(await n.Z.expense.findMany({where:{barbershopId:e},orderBy:{expenseDate:"desc"}})).map(o)}async function p(e){return o(await n.Z.expense.create({data:{id:(0,s.randomUUID)(),barbershopId:e.barbershopId,description:e.description,category:e.category,expenseType:e.type,amount:new a.Prisma.Decimal(e.amount),expenseDate:e.date,title:e.description}}))}async function u(e,r){return o(await n.Z.expense.update({where:{id:e},data:{description:r.description,title:r.description,category:r.category,expenseType:r.type,amount:void 0!==r.amount?new a.Prisma.Decimal(r.amount):void 0,expenseDate:r.date}}))}async function d(e){await n.Z.expense.delete({where:{id:e}})}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[8948,5972],()=>t(23683));module.exports=a})();
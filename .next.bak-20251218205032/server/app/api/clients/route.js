"use strict";(()=>{var e={};e.id=9652,e.ids=[9652],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},40116:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>f,patchFetch:()=>b,requestAsyncStorage:()=>d,routeModule:()=>c,serverHooks:()=>m,staticGenerationAsyncStorage:()=>h});var o={};t.r(o),t.d(o,{GET:()=>u,POST:()=>l});var a=t(49303),n=t(88716),s=t(60670),i=t(87070),p=t(60988);async function u(e){try{let{searchParams:r}=new URL(e.url),t=r.get("userId");if(t){let e=await (0,p._3)(t);return i.NextResponse.json({data:e})}let o=r.get("barbershopId");if(!o)return i.NextResponse.json({error:"barbershopId \xe9 obrigat\xf3rio"},{status:400});let a=await (0,p.pN)(o);return i.NextResponse.json({data:a})}catch(e){return console.error("GET /api/clients error:",e),i.NextResponse.json({error:"Erro ao listar clientes"},{status:500})}}async function l(e){try{let r=await e.json();if(!r.barbershopId)return i.NextResponse.json({error:"barbershopId \xe9 obrigat\xf3rio"},{status:400});let t=(r.name||"").trim(),o=(r.phone||"").replace(/\D/g,"");if(!t||o.length<10)return i.NextResponse.json({error:"Nome e telefone v\xe1lidos s\xe3o obrigat\xf3rios"},{status:400});if(await (0,p.Fi)(r.barbershopId,o,t))return i.NextResponse.json({error:"J\xe1 existe um cliente com o mesmo nome e telefone."},{status:409});let a=await (0,p.eI)({...r,name:t,phone:o});return i.NextResponse.json({data:a},{status:201})}catch(e){return console.error("POST /api/clients error:",e),i.NextResponse.json({error:"Erro ao criar cliente"},{status:500})}}let c=new a.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/clients/route",pathname:"/api/clients",filename:"route",bundlePath:"app/api/clients/route"},resolvedPagePath:"/var/www/barberflow/src/app/api/clients/route.ts",nextConfigOutput:"",userland:o}),{requestAsyncStorage:d,staticGenerationAsyncStorage:h,serverHooks:m}=c,f="/api/clients/route";function b(){return(0,s.patchFetch)({serverHooks:m,staticGenerationAsyncStorage:h})}},63841:(e,r,t)=>{t.d(r,{Z:()=>a});var o=t(53524);let a=globalThis.prisma??new o.PrismaClient({log:["error"]})},60988:(e,r,t)=>{t.d(r,{Fi:()=>c,Nu:()=>l,Qu:()=>u,_3:()=>i,eI:()=>p,pN:()=>s});var o=t(63841),a=t(84770);function n(e){return{id:e.id,name:e.name,phone:e.phone??"",email:e.email??void 0,userId:e.userId??void 0,notes:e.notes??void 0,favoriteBarbershops:e.favoriteBarbershops?JSON.parse(e.favoriteBarbershops):void 0}}async function s(e){return(await o.Z.client.findMany({where:{barbershopId:e},orderBy:{name:"asc"}})).map(n)}async function i(e){return(await o.Z.client.findMany({where:{userId:e},orderBy:{name:"asc"}})).map(n)}async function p(e){return n(await o.Z.client.create({data:{id:(0,a.randomUUID)(),barbershopId:e.barbershopId,name:e.name,phone:e.phone,email:e.email,userId:e.userId??void 0,notes:e.notes,favoriteBarbershops:e.favoriteBarbershops?JSON.stringify(e.favoriteBarbershops):void 0}}))}async function u(e,r){return n(await o.Z.client.update({where:{id:e},data:{name:r.name,phone:r.phone,email:r.email,userId:r.userId??void 0,notes:r.notes,favoriteBarbershops:r.favoriteBarbershops?JSON.stringify(r.favoriteBarbershops):void 0}}))}async function l(e){await o.Z.client.delete({where:{id:e}})}async function c(e,r,t){let a=await o.Z.client.findFirst({where:{barbershopId:e,phone:r}});return a&&(a.name||"").trim().toLowerCase()===t.trim().toLowerCase()?n(a):null}}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),o=r.X(0,[8948,5972],()=>t(40116));module.exports=o})();
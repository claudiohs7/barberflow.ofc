"use strict";(()=>{var e={};e.id=7716,e.ids=[7716],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},84770:e=>{e.exports=require("crypto")},44470:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>w,patchFetch:()=>f,requestAsyncStorage:()=>c,routeModule:()=>l,serverHooks:()=>h,staticGenerationAsyncStorage:()=>d});var a={};t.r(a),t.d(a,{POST:()=>p});var o=t(49303),n=t(88716),s=t(60670),u=t(87070),i=t(77141);async function p(e){try{let r=e.cookies.get("refresh_token");if(r){let e=await (0,i.cI)(r.value);e&&await (0,i.l$)(e.id)}let t=u.NextResponse.json({success:!0});return t.cookies.set("refresh_token","",{maxAge:-1,path:"/"}),t}catch(e){return console.error("POST /api/auth/logout error:",e),u.NextResponse.json({error:"N\xe3o foi poss\xedvel sair"},{status:500})}}let l=new o.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/auth/logout/route",pathname:"/api/auth/logout",filename:"route",bundlePath:"app/api/auth/logout/route"},resolvedPagePath:"/var/www/barberflow/src/app/api/auth/logout/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:c,staticGenerationAsyncStorage:d,serverHooks:h}=l,w="/api/auth/logout/route";function f(){return(0,s.patchFetch)({serverHooks:h,staticGenerationAsyncStorage:d})}},63841:(e,r,t)=>{t.d(r,{Z:()=>o});var a=t(53524);let o=globalThis.prisma??new a.PrismaClient({log:["error"]})},77141:(e,r,t)=>{t.d(r,{BA:()=>h,Lj:()=>w,TK:()=>u,Zy:()=>d,cI:()=>l,cJ:()=>c,l$:()=>p,r4:()=>s,zI:()=>i});var a=t(98691),o=t(63841);async function n(e){return o.Z.user.findUnique({where:{email:e.toLowerCase()}})}async function s(e){if(await n(e.email))throw Error("E-mail j\xe1 est\xe1 em uso.");let r=await a.ZP.hash(e.password,12);return o.Z.user.create({data:{id:crypto.randomUUID(),email:e.email.toLowerCase(),name:e.name,phone:e.phone,passwordHash:r,role:e.role??"CLIENT",avatarUrl:e.avatarUrl}})}async function u(e,r){let t=await n(e);return t&&t.passwordHash&&await a.ZP.compare(r,t.passwordHash)?t:null}async function i(e,r){await o.Z.user.update({where:{id:e},data:{refreshToken:r}})}async function p(e){await o.Z.user.update({where:{id:e},data:{refreshToken:null}})}async function l(e){return e?o.Z.user.findFirst({where:{refreshToken:e}}):null}async function c(e,r){return o.Z.user.update({where:{id:e},data:{email:r}})}async function d(e,r){let t=await a.ZP.hash(r,12);return o.Z.user.update({where:{id:e},data:{passwordHash:t}})}async function h(e,r){return o.Z.user.update({where:{id:e},data:{avatarUrl:r}})}async function w(e,r){return o.Z.user.update({where:{id:e},data:{name:r.name??void 0,phone:r.phone??void 0}})}}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[8948,5972,8691],()=>t(44470));module.exports=a})();
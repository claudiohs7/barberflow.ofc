"use strict";(()=>{var e={};e.id=775,e.ids=[775],e.modules={53524:e=>{e.exports=require("@prisma/client")},20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},51744:(e,r,t)=>{t.r(r),t.d(r,{originalPathname:()=>b,patchFetch:()=>x,requestAsyncStorage:()=>c,routeModule:()=>l,serverHooks:()=>f,staticGenerationAsyncStorage:()=>g});var a={};t.r(a),t.d(a,{POST:()=>d});var s=t(49303),n=t(88716),o=t(60670),p=t(87070),i=t(63841);function u(e){return{id:e.id,name:e.name,content:e.content,enabled:e.enabled,type:e.type,reminderHoursBefore:e.reminderHoursBefore??null}}async function m(e,r){let t=[i.Z.messagetemplate.deleteMany({where:{barbershopId:e}}),...r.map(r=>i.Z.messagetemplate.create({data:{id:r.id,barbershopId:e,name:r.name,content:r.content,enabled:r.enabled,type:r.type,reminderHoursBefore:r.reminderHoursBefore??null}}))];return(await i.Z.$transaction(t)).slice(1).map(u)}async function d(e){try{let r=await e.json();if(!r.barbershopId)return p.NextResponse.json({error:"Barbearia n\xe3o encontrada"},{status:400});if(!Array.isArray(r.messageTemplates))return p.NextResponse.json({error:"Os modelos de mensagem devem ser enviados como um array."},{status:400});let t=r.messageTemplates.map(e=>({...e,enabled:!!e.enabled,reminderHoursBefore:"number"==typeof e.reminderHoursBefore?e.reminderHoursBefore:null})),a=await m(r.barbershopId,t);return p.NextResponse.json({data:a})}catch(e){return console.error("POST /api/message-templates/update error:",e),p.NextResponse.json({error:e?.message||"Erro ao atualizar os modelos."},{status:500})}}let l=new s.AppRouteRouteModule({definition:{kind:n.x.APP_ROUTE,page:"/api/message-templates/update/route",pathname:"/api/message-templates/update",filename:"route",bundlePath:"app/api/message-templates/update/route"},resolvedPagePath:"/var/www/barberflow/src/app/api/message-templates/update/route.ts",nextConfigOutput:"",userland:a}),{requestAsyncStorage:c,staticGenerationAsyncStorage:g,serverHooks:f}=l,b="/api/message-templates/update/route";function x(){return(0,o.patchFetch)({serverHooks:f,staticGenerationAsyncStorage:g})}},63841:(e,r,t)=>{t.d(r,{Z:()=>s});var a=t(53524);let s=globalThis.prisma??new a.PrismaClient({log:["error"]})}};var r=require("../../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),a=r.X(0,[8948,5972],()=>t(51744));module.exports=a})();
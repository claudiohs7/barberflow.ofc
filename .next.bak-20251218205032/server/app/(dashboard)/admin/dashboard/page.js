(()=>{var e={};e.id=7446,e.ids=[7446],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},85360:(e,r,a)=>{"use strict";a.r(r),a.d(r,{GlobalError:()=>o.a,__next_app__:()=>u,originalPathname:()=>m,pages:()=>c,routeModule:()=>h,tree:()=>i}),a(4889),a(44898),a(61930),a(6989),a(35866),a(98128);var t=a(23191),s=a(88716),n=a(37922),o=a.n(n),l=a(95231),d={};for(let e in l)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(d[e]=()=>l[e]);a.d(r,d);let i=["",{children:["(dashboard)",{children:["admin",{children:["dashboard",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(a.bind(a,4889)),"/var/www/barberflow/src/app/(dashboard)/admin/dashboard/page.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,44898)),"/var/www/barberflow/src/app/(dashboard)/admin/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,61930)),"/var/www/barberflow/src/app/(dashboard)/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(a.bind(a,6989)),"/var/www/barberflow/src/app/(dashboard)/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,2304))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(a.bind(a,98128)),"/var/www/barberflow/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(a.t.bind(a,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(a.bind(a,2304))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],c=["/var/www/barberflow/src/app/(dashboard)/admin/dashboard/page.tsx"],m="/(dashboard)/admin/dashboard/page",u={require:a,loadChunk:()=>Promise.resolve()},h=new t.AppPageRouteModule({definition:{kind:s.x.APP_PAGE,page:"/(dashboard)/admin/dashboard/page",pathname:"/admin/dashboard",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:i}})},21491:(e,r,a)=>{Promise.resolve().then(a.bind(a,25455))},25455:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>D});var t=a(10326),s=a(17577),n=a(29752),o=a(18278),l=a(18423),d=a(62637),i=a(8564),c=a(5277),m=a(291),u=a(43891);let h=(0,a(9664).Z)("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);var p=a(25996),x=a(94872),b=a(20586),f=a(31855),g=a(51223),v=a(91664),j=a(3594),y=a(69559),w=a(53704),N=a(99515),k=a(71271);function _(e){let r=(0,k.Q)(e);return r.setHours(23,59,59,999),r}var C=a(36014),P=a(81599),S=a(90434),M=a(39483),I=a(84097),Z=a(74690),$=a(76488);let A={appointments:{label:"Agendamentos",color:"hsl(var(--primary))"}};function D(){let{user:e}=(0,Z.a)(),{barbershopId:r,isLoading:a}=(0,P.Y)(),{toast:D}=(0,I.pm)(),[q,T]=(0,s.useState)(!1),[L,O]=(0,s.useState)(0),[E,G]=(0,s.useState)({from:(0,y.N)(new Date),to:(0,w.V)(new Date)}),[R,U]=(0,s.useState)(null),[K,z]=(0,s.useState)([]),[B,F]=(0,s.useState)([]),[Q,V]=(0,s.useState)([]),[Y,H]=(0,s.useState)([]),[W,X]=(0,s.useState)(!0);(0,s.useCallback)(async()=>{if(!r){U(null),z([]),F([]),V([]),H([]),X(!1);return}X(!0);try{let[e,a,t,s,n]=await Promise.all([(0,$.rd)(`/api/barbershops/${encodeURIComponent(r)}`),(0,$.rd)(`/api/barbers?barbershopId=${encodeURIComponent(r)}`),(0,$.rd)(`/api/services?barbershopId=${encodeURIComponent(r)}`),(0,$.rd)(`/api/expenses?barbershopId=${encodeURIComponent(r)}`),(0,$.rd)(`/api/appointments?barbershopId=${encodeURIComponent(r)}`)]);U(e.data??null),z(a.data??[]),F(t.data??[]),H(s.data?.map(e=>({...e,date:new Date(e.date)}))??[]),V((n.data??[]).map(e=>({...e,startTime:new Date(e.startTime),endTime:new Date(e.endTime)})))}catch(e){D({variant:"destructive",title:"Erro ao carregar o dashboard",description:e.message||"N\xe3o foi poss\xedvel carregar os dados da barbearia."})}finally{X(!1)}},[r,D]),e?.email;let J=(0,s.useMemo)(()=>{if(!Q)return[];if(!E||!E.from)return Q;let e=(0,N.b)(E.from),r=E.to?_(E.to):_(E.from);return Q.filter(a=>(0,C._)(a.startTime,{start:e,end:r}))},[Q,E]),ee=(0,s.useMemo)(()=>J&&B?J.filter(e=>"completed"===e.status||"confirmed"===e.status).reduce((e,r)=>e+B.filter(e=>r.serviceIds.includes(e.id)).reduce((e,r)=>e+r.price,0),0):0,[J,B]),er=(0,s.useMemo)(()=>{if(!Y)return 0;if(!E||!E.from)return Y.reduce((e,r)=>e+r.amount,0);let e=(0,N.b)(E.from),r=E.to?_(E.to):_(E.from);return Y.filter(a=>a.date&&(0,C._)(a.date,{start:e,end:r})).reduce((e,r)=>e+r.amount,0)},[Y,E]),ea=(0,s.useMemo)(()=>ee-er,[ee,er]),et=(0,s.useMemo)(()=>J?J.length:0,[J]),es=(0,s.useMemo)(()=>{let e=["Dom","Seg","Ter","Qua","Qui","Sex","S\xe1b"].map(e=>({name:e,appointments:0}));return J&&J.forEach(r=>{var a;let t=(a=r.startTime,(0,k.Q)(a).getDay());e[t]&&e[t].appointments++}),e},[J]),en=(0,s.useMemo)(()=>[{title:"Faturamento no Per\xedodo",value:(0,g.xG)(ee),icon:m.Z,color:"text-green-500",bgColor:"bg-green-500/10",href:void 0},{title:"Despesas no Per\xedodo",value:(0,g.xG)(er),icon:u.Z,color:"text-red-500",bgColor:"bg-red-500/10",href:"/admin/dashboard/expenses"},{title:"Lucro no Per\xedodo",value:(0,g.xG)(ea),icon:h,color:ea>=0?"text-blue-500":"text-red-500",bgColor:ea>=0?"bg-blue-500/10":"bg-red-500/10",href:void 0},{title:"Agendamentos no Per\xedodo",value:et.toString(),icon:p.Z,color:"text-purple-500",bgColor:"bg-purple-500/10",href:"/admin/dashboard/schedule"}],[ee,er,ea,et]),eo=(0,s.useMemo)(()=>{if(!J||!K||!B)return[];let e=new Map;for(let r of J){let a=e.get(r.barberId)||{total:0,breakdown:{}};for(let e of(a.total+=r.serviceIds.length,r.serviceIds)){let r=B.find(r=>r.id===e);r&&(a.breakdown[r.name]=(a.breakdown[r.name]||0)+1)}e.set(r.barberId,a)}return K.map(r=>{let a=e.get(r.id);return{barberId:r.id,barberName:r.name,barberAvatar:r.avatarUrl,totalServices:a?.total||0,serviceBreakdown:a?.breakdown||{}}}).sort((e,r)=>r.totalServices-e.totalServices)},[J,K,B]),[el,ed]=(0,s.useState)(""),ei=e=>{navigator.clipboard.writeText(e).then(()=>{D({title:"Copiado!",description:"O texto foi copiado para a \xe1rea de transfer\xeancia."})}).catch(e=>{D({variant:"destructive",title:"Erro ao Copiar",description:"N\xe3o foi poss\xedvel copiar."})})};return a||W?t.jsx("div",{className:"p-6",children:"Carregando dashboard..."}):(R?.plan,(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[(0,t.jsxs)("h1",{className:"text-3xl font-bold font-headline",children:["Dashboard da ",R?.name]}),t.jsx(M.D,{date:E,onDateChange:G,className:"mt-4 sm:mt-0"})]}),t.jsx("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:en.map((e,r)=>(0,t.jsxs)(n.Zb,{className:"flex flex-col p-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:(0,g.cn)("flex items-center justify-center h-12 w-12 rounded-lg",e.bgColor),children:t.jsx(e.icon,{className:(0,g.cn)("h-6 w-6",e.color)})}),(0,t.jsxs)("div",{children:[t.jsx(n.SZ,{children:e.title}),t.jsx(n.ll,{className:"text-2xl font-bold",children:e.value})]})]}),e.href&&t.jsx(n.eW,{className:"p-0 pt-4 mt-auto",children:t.jsx(v.z,{asChild:!0,variant:"link",className:"p-0 h-auto text-xs text-muted-foreground",children:t.jsx(S.default,{href:e.href,children:"Ver tudo"})})})]},r))}),(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)(n.Zb,{children:[t.jsx(n.Ol,{children:t.jsx(n.ll,{className:"text-base font-medium",children:"Link P\xfablico para Agendamentos"})}),(0,t.jsxs)(n.aY,{className:"p-4 pt-0 space-y-2",children:[t.jsx("p",{className:"text-sm text-muted-foreground",children:"Use o link abaixo para divulgar sua p\xe1gina de agendamentos."}),(0,t.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between gap-2 p-2 rounded-md bg-muted/50 border",children:[t.jsx("span",{className:"font-mono text-sm text-foreground truncate flex-1",children:el}),(0,t.jsxs)("div",{className:"flex gap-2",children:[t.jsx(v.z,{asChild:!0,size:"sm",className:"shrink-0",children:(0,t.jsxs)(S.default,{href:el,target:"_blank",children:[t.jsx(x.Z,{className:"mr-2 h-4 w-4"}),"Abrir"]})}),(0,t.jsxs)(v.z,{onClick:()=>ei(el),size:"sm",className:"shrink-0",children:[t.jsx(b.Z,{className:"mr-2 h-4 w-4"}),"Copiar"]})]})]})]})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[t.jsx("div",{className:"lg:col-span-2",children:(0,t.jsxs)(n.Zb,{children:[(0,t.jsxs)(n.Ol,{children:[t.jsx(n.ll,{children:"Agendamentos da Semana"}),t.jsx(n.SZ,{children:"Um resumo dos agendamentos da sua barbearia para o per\xedodo selecionado."})]}),t.jsx(n.aY,{children:t.jsx(c.BO,{config:A,className:"h-[350px] w-full",children:(0,t.jsxs)(o.v,{accessibilityLayer:!0,data:es,margin:{left:12,right:12},children:[t.jsx(l.q,{vertical:!1}),t.jsx(d.K,{dataKey:"name",tickLine:!1,axisLine:!1,tickMargin:8,tickFormatter:e=>e.slice(0,3)}),t.jsx(c.h7,{cursor:!1,content:t.jsx(c.dg,{indicator:"dot"})}),t.jsx(i.$,{dataKey:"appointments",fill:"var(--color-appointments)",radius:4})]})})})]})}),t.jsx("div",{className:"lg:col-span-1",children:(0,t.jsxs)(n.Zb,{className:"h-full",children:[(0,t.jsxs)(n.Ol,{children:[(0,t.jsxs)(n.ll,{className:"flex items-center gap-2",children:[t.jsx(f.Z,{className:"h-5 w-5"})," Desempenho dos Barbeiros"]}),t.jsx("p",{className:"text-sm text-muted-foreground",children:"Desempenho no per\xedodo selecionado"})]}),t.jsx(n.aY,{className:"space-y-4",children:0===eo.length?t.jsx("div",{className:"text-center text-muted-foreground py-10",children:"Nenhum servi\xe7o registrado neste per\xedodo."}):eo.map(e=>(0,t.jsxs)("div",{className:"flex items-start gap-4",children:[(0,t.jsxs)(j.Avatar,{children:[t.jsx(j.AvatarImage,{src:e.barberAvatar,alt:e.barberName}),t.jsx(j.AvatarFallback,{children:e.barberName.charAt(0)})]}),(0,t.jsxs)("div",{className:"flex-1",children:[t.jsx("p",{className:"font-medium",children:e.barberName}),e.totalServices>0?t.jsx("div",{className:"text-xs text-muted-foreground",children:Object.entries(e.serviceBreakdown).map(([e,r])=>`${e}: ${r}`).join(", ")}):t.jsx("p",{className:"text-xs text-muted-foreground",children:"Nenhum servi\xe7o"})]}),(0,t.jsxs)("div",{className:"text-right",children:[t.jsx("p",{className:"font-bold text-lg",children:e.totalServices}),t.jsx("p",{className:"text-xs text-muted-foreground",children:"servi\xe7os"})]})]},e.barberId))})]})})]})]})]}))}},5277:(e,r,a)=>{"use strict";a.d(r,{BO:()=>u,dg:()=>x,h7:()=>p});var t=a(10326),s=a(17577),n=a(30660),o=a(44675),l=a(69274),d=a(51223);let i={light:"",dark:".dark"},c=s.createContext(null);function m(){let e=s.useContext(c);if(!e)throw Error("useChart must be used within a <ChartContainer />");return e}let u=s.forwardRef(({id:e,className:r,children:a,config:o,...l},i)=>{let m=s.useId(),u=`chart-${e||m.replace(/:/g,"")}`;return t.jsx(c.Provider,{value:{config:o},children:(0,t.jsxs)("div",{"data-chart":u,ref:i,className:(0,d.cn)("flex aspect-video justify-center text-xs [&_.recharts-cartesian-axis-tick_text]:fill-muted-foreground [&_.recharts-cartesian-grid_line[stroke='#ccc']]:stroke-border/50 [&_.recharts-curve.recharts-tooltip-cursor]:stroke-border [&_.recharts-dot[stroke='#fff']]:stroke-transparent [&_.recharts-layer]:outline-none [&_.recharts-polar-grid_[stroke='#ccc']]:stroke-border [&_.recharts-radial-bar-background-sector]:fill-muted [&_.recharts-rectangle.recharts-tooltip-cursor]:fill-muted [&_.recharts-reference-line_[stroke='#ccc']]:stroke-border [&_.recharts-sector[stroke='#fff']]:stroke-transparent [&_.recharts-sector]:outline-none [&_.recharts-surface]:outline-none",r),...l,children:[t.jsx(h,{id:u,config:o}),t.jsx(n.h,{children:a})]})})});u.displayName="Chart";let h=({id:e,config:r})=>{let a=Object.entries(r).filter(([,e])=>e.theme||e.color);return a.length?t.jsx("style",{dangerouslySetInnerHTML:{__html:Object.entries(i).map(([r,t])=>`
${t} [data-chart=${e}] {
${a.map(([e,a])=>{let t=a.theme?.[r]||a.color;return t?`  --color-${e}: ${t};`:null}).join("\n")}
}
`).join("\n")}}):null},p=o.u,x=s.forwardRef(({active:e,payload:r,className:a,indicator:n="dot",hideLabel:o=!1,hideIndicator:l=!1,label:i,labelFormatter:c,labelClassName:u,formatter:h,color:p,nameKey:x,labelKey:f},g)=>{let{config:v}=m(),j=s.useMemo(()=>{if(o||!r?.length)return null;let[e]=r,a=`${f||e.dataKey||e.name||"value"}`,s=b(v,e,a),n=f||"string"!=typeof i?s?.label:v[i]?.label||i;return c?t.jsx("div",{className:(0,d.cn)("font-medium",u),children:c(n,r)}):n?t.jsx("div",{className:(0,d.cn)("font-medium",u),children:n}):null},[i,c,r,o,u,v,f]);if(!e||!r?.length)return null;let y=1===r.length&&"dot"!==n;return(0,t.jsxs)("div",{ref:g,className:(0,d.cn)("grid min-w-[8rem] items-start gap-1.5 rounded-lg border border-border/50 bg-background px-2.5 py-1.5 text-xs shadow-xl",a),children:[y?null:j,t.jsx("div",{className:"grid gap-1.5",children:r.map((e,r)=>{let a=`${x||e.name||e.dataKey||"value"}`,s=b(v,e,a),o=p||e.payload.fill||e.color;return t.jsx("div",{className:(0,d.cn)("flex w-full flex-wrap items-stretch gap-2 [&>svg]:h-2.5 [&>svg]:w-2.5 [&>svg]:text-muted-foreground","dot"===n&&"items-center"),children:h&&e?.value!==void 0&&e.name?h(e.value,e.name,e,r,e.payload):(0,t.jsxs)(t.Fragment,{children:[s?.icon?t.jsx(s.icon,{}):!l&&t.jsx("div",{className:(0,d.cn)("shrink-0 rounded-[2px] border-[--color-border] bg-[--color-bg]",{"h-2.5 w-2.5":"dot"===n,"w-1":"line"===n,"w-0 border-[1.5px] border-dashed bg-transparent":"dashed"===n,"my-0.5":y&&"dashed"===n}),style:{"--color-bg":o,"--color-border":o}}),(0,t.jsxs)("div",{className:(0,d.cn)("flex flex-1 justify-between leading-none",y?"items-end":"items-center"),children:[(0,t.jsxs)("div",{className:"grid gap-1.5",children:[y?j:null,t.jsx("span",{className:"text-muted-foreground",children:s?.label||e.name})]}),e.value&&t.jsx("span",{className:"font-mono font-medium tabular-nums text-foreground",children:e.value.toLocaleString()})]})]})},e.dataKey)})})]})});function b(e,r,a){if("object"!=typeof r||null===r)return;let t="payload"in r&&"object"==typeof r.payload&&null!==r.payload?r.payload:void 0,s=a;return a in r&&"string"==typeof r[a]?s=r[a]:t&&a in t&&"string"==typeof t[a]&&(s=t[a]),s in e?e[s]:e[a]}x.displayName="ChartTooltip",l.D,s.forwardRef(({className:e,hideIcon:r=!1,payload:a,verticalAlign:s="bottom",nameKey:n},o)=>{let{config:l}=m();return a?.length?t.jsx("div",{ref:o,className:(0,d.cn)("flex items-center justify-center gap-4","top"===s?"pb-3":"pt-3",e),children:a.map(e=>{let a=`${n||e.dataKey||"value"}`,s=b(l,e,a);return(0,t.jsxs)("div",{className:(0,d.cn)("flex items-center gap-1.5 [&>svg]:h-3 [&>svg]:w-3 [&>svg]:text-muted-foreground"),children:[s?.icon&&!r?t.jsx(s.icon,{}):t.jsx("div",{className:"h-2 w-2 shrink-0 rounded-[2px]",style:{backgroundColor:e.color}}),s?.label]},e.value)})}):null}).displayName="ChartLegend"},4889:(e,r,a)=>{"use strict";a.r(r),a.d(r,{default:()=>t});let t=(0,a(68570).createProxy)(String.raw`/var/www/barberflow/src/app/(dashboard)/admin/dashboard/page.tsx#default`)},25996:(e,r,a)=>{"use strict";a.d(r,{Z:()=>t});let t=(0,a(9664).Z)("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]])},20586:(e,r,a)=>{"use strict";a.d(r,{Z:()=>t});let t=(0,a(9664).Z)("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]])},94872:(e,r,a)=>{"use strict";a.d(r,{Z:()=>t});let t=(0,a(9664).Z)("ExternalLink",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])}};var r=require("../../../../webpack-runtime.js");r.C(e);var a=e=>r(r.s=e),t=r.X(0,[8948,7925,2535,434,1458,1245,7389,4020,5269,2309,6951,6999,9529,7863,6039,7154,3799,9788,8494,7540],()=>a(85360));module.exports=t})();
(()=>{var e={};e.id=1623,e.ids=[1623],e.modules={72934:e=>{"use strict";e.exports=require("next/dist/client/components/action-async-storage.external.js")},54580:e=>{"use strict";e.exports=require("next/dist/client/components/request-async-storage.external.js")},45869:e=>{"use strict";e.exports=require("next/dist/client/components/static-generation-async-storage.external.js")},20399:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},55315:e=>{"use strict";e.exports=require("path")},17360:e=>{"use strict";e.exports=require("url")},94692:(e,a,s)=>{"use strict";s.r(a),s.d(a,{GlobalError:()=>l.a,__next_app__:()=>h,originalPathname:()=>p,pages:()=>o,routeModule:()=>m,tree:()=>c}),s(37121),s(44898),s(61930),s(6989),s(35866),s(98128);var t=s(23191),r=s(88716),i=s(37922),l=s.n(i),d=s(95231),n={};for(let e in d)0>["default","tree","pages","GlobalError","originalPathname","__next_app__","routeModule"].indexOf(e)&&(n[e]=()=>d[e]);s.d(a,n);let c=["",{children:["(dashboard)",{children:["admin",{children:["dashboard",{children:["support",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(s.bind(s,37121)),"/var/www/barberflow/src/app/(dashboard)/admin/dashboard/support/page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(s.bind(s,44898)),"/var/www/barberflow/src/app/(dashboard)/admin/dashboard/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,61930)),"/var/www/barberflow/src/app/(dashboard)/admin/layout.tsx"]}]},{layout:[()=>Promise.resolve().then(s.bind(s,6989)),"/var/www/barberflow/src/app/(dashboard)/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,2304))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}]},{layout:[()=>Promise.resolve().then(s.bind(s,98128)),"/var/www/barberflow/src/app/layout.tsx"],"not-found":[()=>Promise.resolve().then(s.t.bind(s,35866,23)),"next/dist/client/components/not-found-error"],metadata:{icon:[async e=>(await Promise.resolve().then(s.bind(s,2304))).default(e)],apple:[],openGraph:[],twitter:[],manifest:void 0}}],o=["/var/www/barberflow/src/app/(dashboard)/admin/dashboard/support/page.tsx"],p="/(dashboard)/admin/dashboard/support/page",h={require:s,loadChunk:()=>Promise.resolve()},m=new t.AppPageRouteModule({definition:{kind:r.x.APP_PAGE,page:"/(dashboard)/admin/dashboard/support/page",pathname:"/admin/dashboard/support",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:c}})},92809:(e,a,s)=>{Promise.resolve().then(s.bind(s,53692))},53692:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>P});var t=s(10326),r=s(17577),i=s(91664),l=s(29752),d=s(41190),n=s(44794),c=s(29280),o=s(82015),p=s(84097);let h=(0,s(9664).Z)("LifeBuoy",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.93 4.93 4.24 4.24",key:"1ymg45"}],["path",{d:"m14.83 9.17 4.24-4.24",key:"1cb5xl"}],["path",{d:"m14.83 14.83 4.24 4.24",key:"q42g0n"}],["path",{d:"m9.17 14.83-4.24 4.24",key:"bqpfvv"}],["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}]]);var m=s(46721),x=s(42556),u=s(79611),y=s(31798),v=s(37084),j=s(74690),f=s(81599),g=s(24118),b=s(55296),k=s(51223),w=s(76488),N=s(3236),Z=s(3594);let M=["D\xfavida Geral","Problema T\xe9cnico","Financeiro/Assinatura","Sugest\xe3o"],C={open:"Aberto",in_progress:"Em progresso",closed:"Fechado"};function P(){let{user:e}=(0,j.a)(),{barbershopId:a}=(0,f.Y)(),{toast:s}=(0,p.pm)(),P=e?.email==="claudiohs@hotmail.com",[E,S]=(0,r.useState)([]),[_,q]=(0,r.useState)(!1),[T,A]=(0,r.useState)(!1),[z,O]=(0,r.useState)(""),[H,L]=(0,r.useState)(""),[D,V]=(0,r.useState)(""),[$,G]=(0,r.useState)(null),[R,B]=(0,r.useState)([]),[F,Y]=(0,r.useState)(!1),[Q,I]=(0,r.useState)(""),[J,U]=(0,r.useState)(!1),W=(0,r.useCallback)(async()=>{q(!0);try{let e=a?`?barbershopId=${encodeURIComponent(a)}`:"",s=await (0,w.rd)(`/api/tickets${e}`);S(s.data||[])}catch(e){console.error("Erro ao carregar tickets:",e),s({variant:"destructive",title:"Erro",description:"N\xe3o foi poss\xedvel carregar tickets."})}finally{q(!1)}},[a,s]),K=async e=>{try{let a=await (0,w.rd)(`/api/tickets/${e}/responses`);B(a.data||[])}catch(e){console.error("Erro ao carregar respostas:",e)}},X=async()=>{if(!z||!H||!D){s({variant:"destructive",title:"Erro",description:"Preencha todos os campos obrigat\xf3rios."});return}A(!0);try{let t=await (0,w.rd)("/api/tickets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({barbershopId:a,title:H,description:D,category:z,createdBy:e?.id||"anonymous",clientEmail:e?.email||"N\xe3o informado",clientName:e?.name||"N\xe3o informado",status:"open",priority:"medium"})});S(e=>[t.data,...e]),O(""),L(""),V(""),s({title:"Ticket enviado!",description:"Sua solicita\xe7\xe3o foi registrada."})}catch(e){s({variant:"destructive",title:"Erro ao enviar",description:e.message||"Tente novamente."})}finally{A(!1)}},ee=async e=>{G(e),Y(!0),await K(e.id)},ea=async()=>{if(Q.trim()&&$)try{let a=await (0,w.rd)(`/api/tickets/${$.id}/responses`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({message:Q,createdBy:e?.id||"anonymous",isAdmin:P})});B(e=>[...e,a.data]),I(""),"open"===$.status&&P&&await es($.id,"in_progress")}catch(e){s({variant:"destructive",title:"Erro",description:e.message||"N\xe3o foi poss\xedvel enviar a resposta."})}},es=async(e,a)=>{try{let s=await (0,w.rd)(`/api/tickets/${e}`,{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify({status:a})});S(a=>a.map(a=>a.id===e?s.data:a)),$&&$.id===e&&G(s.data)}catch(e){s({variant:"destructive",title:"Erro",description:e.message||"N\xe3o foi poss\xedvel atualizar o status."})}},et=async()=>{if($)try{await (0,w.rd)(`/api/tickets/${$.id}`,{method:"DELETE"}),S(e=>e.filter(e=>e.id!==$.id)),Y(!1),s({title:"Ticket exclu\xeddo",description:"O ticket foi removido."})}catch(e){s({variant:"destructive",title:"Erro",description:e.message||"N\xe3o foi poss\xedvel excluir o ticket."})}finally{U(!1)}},er=(0,r.useMemo)(()=>z&&H&&D,[z,H,D]);return(0,t.jsxs)("div",{className:"space-y-6",children:[(0,t.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2",children:[t.jsx(h,{className:"h-5 w-5"})," Abrir Ticket"]}),t.jsx(l.SZ,{children:"Envie uma solicita\xe7\xe3o para nossa equipe de suporte."})]}),(0,t.jsxs)(l.aY,{className:"space-y-4",children:[(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(n._,{children:"Assunto"}),(0,t.jsxs)(c.Ph,{value:z,onValueChange:O,children:[t.jsx(c.i4,{children:t.jsx(c.ki,{placeholder:"Selecione um assunto"})}),t.jsx(c.Bw,{children:M.map(e=>t.jsx(c.Ql,{value:e,children:e},e))})]})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(n._,{children:"T\xedtulo"}),t.jsx(d.I,{value:H,onChange:e=>L(e.target.value),placeholder:"Resumo do problema"})]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(n._,{children:"Descri\xe7\xe3o"}),t.jsx(o.g,{value:D,onChange:e=>V(e.target.value),placeholder:"Detalhe sua solicita\xe7\xe3o",rows:4})]})]}),t.jsx(l.eW,{className:"flex justify-end",children:(0,t.jsxs)(i.z,{onClick:X,disabled:!er||T,children:[T?t.jsx(m.Z,{className:"h-4 w-4 animate-spin mr-2"}):t.jsx(x.Z,{className:"h-4 w-4 mr-2"}),"Enviar"]})})]}),(0,t.jsxs)(l.Zb,{children:[(0,t.jsxs)(l.Ol,{className:"flex flex-row items-center justify-between",children:[(0,t.jsxs)("div",{children:[(0,t.jsxs)(l.ll,{className:"flex items-center gap-2",children:[t.jsx(u.Z,{className:"h-5 w-5"})," Tickets"]}),t.jsx(l.SZ,{children:"Visualize e responda \xe0s solicita\xe7\xf5es."})]}),t.jsx(i.z,{variant:"ghost",onClick:W,disabled:_,children:t.jsx(y.Z,{className:(0,k.cn)("h-4 w-4",_&&"animate-spin")})})]}),t.jsx(l.aY,{className:"space-y-2 max-h-[480px] overflow-y-auto",children:_?(0,t.jsxs)("div",{className:"flex items-center gap-2 text-muted-foreground",children:[t.jsx(m.Z,{className:"h-4 w-4 animate-spin"}),"Carregando tickets..."]}):0===E.length?t.jsx("p",{className:"text-muted-foreground",children:"Nenhum ticket encontrado."}):E.map(e=>(0,t.jsxs)("div",{className:"p-3 border rounded-md hover:border-primary transition cursor-pointer",onClick:()=>ee(e),children:[(0,t.jsxs)("div",{className:"flex items-center justify-between",children:[(0,t.jsxs)("div",{children:[t.jsx("p",{className:"font-semibold",children:e.title}),t.jsx("p",{className:"text-xs text-muted-foreground",children:e.category})]}),t.jsx("div",{className:"text-xs px-2 py-1 rounded-full bg-muted",children:C[e.status]})]}),t.jsx("p",{className:"text-sm text-muted-foreground line-clamp-2 mt-1",children:e.description})]},e.id))})]})]}),t.jsx(g.Vq,{open:F,onOpenChange:Y,children:(0,t.jsxs)(g.cZ,{className:"sm:max-w-2xl",children:[(0,t.jsxs)(g.fK,{children:[(0,t.jsxs)(g.$N,{className:"flex items-center gap-2",children:[t.jsx(u.Z,{className:"h-5 w-5"})," ",$?.title]}),t.jsx(g.Be,{children:$?.description})]}),(0,t.jsxs)("div",{className:"grid grid-cols-1 gap-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[t.jsx("span",{children:"Status:"}),(0,t.jsxs)(c.Ph,{value:$?.status,onValueChange:e=>$&&es($.id,e),children:[t.jsx(c.i4,{className:"w-40",children:t.jsx(c.ki,{})}),(0,t.jsxs)(c.Bw,{children:[t.jsx(c.Ql,{value:"open",children:"Aberto"}),t.jsx(c.Ql,{value:"in_progress",children:"Em progresso"}),t.jsx(c.Ql,{value:"closed",children:"Fechado"})]})]})]}),(0,t.jsxs)(N.x,{className:"h-64 rounded-md border p-3",id:"chat-scroll",children:[$&&(0,t.jsxs)("div",{className:"mb-4",children:[(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[t.jsx(Z.Avatar,{className:"h-8 w-8",children:t.jsx(Z.AvatarFallback,{children:$.clientName?.charAt(0)||"C"})}),(0,t.jsxs)("div",{children:[t.jsx("p",{className:"font-semibold",children:$.clientName}),t.jsx("p",{className:"text-xs text-muted-foreground",children:$.clientEmail})]})]}),t.jsx("p",{className:"mt-2 text-sm",children:$.description})]}),R.map(e=>t.jsx("div",{className:(0,k.cn)("mb-3 flex flex-col",e.isAdmin?"items-end":"items-start"),children:t.jsx("div",{className:"max-w-[80%] rounded-md border bg-muted p-2 text-sm",children:t.jsx("p",{children:e.message})})},e.id))]}),(0,t.jsxs)("div",{className:"space-y-2",children:[t.jsx(n._,{children:"Responder"}),t.jsx(o.g,{value:Q,onChange:e=>I(e.target.value),placeholder:"Escreva uma resposta...",rows:3}),(0,t.jsxs)("div",{className:"flex justify-between",children:[(0,t.jsxs)(i.z,{variant:"destructive",size:"sm",onClick:()=>U(!0),children:[t.jsx(v.Z,{className:"h-4 w-4 mr-2"})," Excluir ticket"]}),(0,t.jsxs)(i.z,{onClick:ea,disabled:!Q.trim(),children:[t.jsx(x.Z,{className:"h-4 w-4 mr-2"})," Enviar resposta"]})]})]})]})]})}),t.jsx(b.aR,{open:J,onOpenChange:U,children:(0,t.jsxs)(b._T,{children:[(0,t.jsxs)(b.fY,{children:[t.jsx(b.f$,{children:"Excluir ticket?"}),t.jsx(b.yT,{children:"Essa a\xe7\xe3o remover\xe1 o ticket e o hist\xf3rico de respostas."})]}),(0,t.jsxs)(b.xo,{children:[t.jsx(b.le,{children:"Cancelar"}),t.jsx(b.OL,{onClick:et,className:"bg-destructive text-white",children:"Confirmar"})]})]})})]})}},44794:(e,a,s)=>{"use strict";s.d(a,{_:()=>c});var t=s(10326),r=s(17577),i=s(34478),l=s(79360),d=s(51223);let n=(0,l.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),c=r.forwardRef(({className:e,...a},s)=>t.jsx(i.f,{ref:s,className:(0,d.cn)(n(),e),...a}));c.displayName=i.f.displayName},37121:(e,a,s)=>{"use strict";s.r(a),s.d(a,{default:()=>t});let t=(0,s(68570).createProxy)(String.raw`/var/www/barberflow/src/app/(dashboard)/admin/dashboard/support/page.tsx#default`)},34478:(e,a,s)=>{"use strict";s.d(a,{f:()=>d});var t=s(17577),r=s(77335),i=s(10326),l=t.forwardRef((e,a)=>(0,i.jsx)(r.WV.label,{...e,ref:a,onMouseDown:a=>{a.target.closest("button, input, select, textarea")||(e.onMouseDown?.(a),!a.defaultPrevented&&a.detail>1&&a.preventDefault())}}));l.displayName="Label";var d=l},60883:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});let t=(0,s(9664).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},22402:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});let t=(0,s(9664).Z)("Contact",[["path",{d:"M16 2v2",key:"scm5qe"}],["path",{d:"M7 22v-2a2 2 0 0 1 2-2h6a2 2 0 0 1 2 2v2",key:"1waht3"}],["path",{d:"M8 2v2",key:"pbkmx"}],["circle",{cx:"12",cy:"11",r:"3",key:"itu57m"}],["rect",{x:"3",y:"4",width:"18",height:"18",rx:"2",key:"12vinp"}]])},86747:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});let t=(0,s(9664).Z)("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]])},51914:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});let t=(0,s(9664).Z)("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]])},43022:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});let t=(0,s(9664).Z)("FileText",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M10 9H8",key:"b1mrlr"}],["path",{d:"M16 13H8",key:"t4e002"}],["path",{d:"M16 17H8",key:"z1uh3a"}]])},39817:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});let t=(0,s(9664).Z)("Headset",[["path",{d:"M3 11h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-5Zm0 0a9 9 0 1 1 18 0m0 0v5a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3Z",key:"12oyoe"}],["path",{d:"M21 16v2a4 4 0 0 1-4 4h-5",key:"1x7m43"}]])},10887:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});let t=(0,s(9664).Z)("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]])},46721:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});let t=(0,s(9664).Z)("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]])},736:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});let t=(0,s(9664).Z)("Scissors",[["circle",{cx:"6",cy:"6",r:"3",key:"1lh9wr"}],["path",{d:"M8.12 8.12 12 12",key:"1alkpv"}],["path",{d:"M20 4 8.12 15.88",key:"xgtan2"}],["circle",{cx:"6",cy:"18",r:"3",key:"fqmcym"}],["path",{d:"M14.8 14.8 20 20",key:"ptml3r"}]])},75801:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});let t=(0,s(9664).Z)("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]])},43891:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});let t=(0,s(9664).Z)("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]])},31855:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});let t=(0,s(9664).Z)("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]])},40342:(e,a,s)=>{"use strict";s.d(a,{Z:()=>t});let t=(0,s(9664).Z)("Youtube",[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]])}};var a=require("../../../../../webpack-runtime.js");a.C(e);var s=e=>a(a.s=e),t=a.X(0,[8948,7925,2535,434,1458,1245,7389,4020,5269,2309,6999,7154,3799,9788,8494,6257],()=>s(94692));module.exports=t})();
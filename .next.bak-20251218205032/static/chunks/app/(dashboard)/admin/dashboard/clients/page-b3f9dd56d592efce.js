(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8713],{88028:function(e,a,t){Promise.resolve().then(t.bind(t,57862))},57862:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return P}});var r=t(57437),n=t(2265),s=t(27648),i=t(12381),l=t(79820),o=t(74291),d=t(30767),c=t(40279),u=t(75060),m=t(96246),p=t(15291),f=t(68245),h=t(46291),x=t(23340),v=t(93448),g=t(94076),b=t(41354),j=t(54233),y=t(23818),N=t(53459),w=t(46747),C=t(15847),S=t(43728),A=t(12032),I=t(26811),_=t(58203),k=t(16357);let D={0:"Domingo",1:"Segunda-feira",2:"Ter\xe7a-feira",3:"Quarta-feira",4:"Quinta-feira",5:"Sexta-feira",6:"S\xe1bado"},T=e=>{let[a,t]=e.split(":").map(Number);return 60*a+t},E=e=>e.replace(/\D/g,""),z=(e,a)=>(null==a?void 0:a.messageTemplates)&&a.messageTemplates.length>0?a.messageTemplates:e,O=e=>{var a,t,r,n,s,i;let l=null==e?void 0:e.address;if(!l)return"";let o=null===(a=l.street)||void 0===a?void 0:a.trim(),d=null===(t=l.number)||void 0===t?void 0:t.trim(),c=null===(r=l.complement)||void 0===r?void 0:r.trim(),u=null===(n=l.neighborhood)||void 0===n?void 0:n.trim(),m=null===(s=l.city)||void 0===s?void 0:s.trim(),p=null===(i=l.state)||void 0===i?void 0:i.trim(),f=[o,d].filter(Boolean).join(", "),h=[u,m,p].filter(Boolean).join(" - ");return[f+(c?" ".concat(c):""),h].filter(Boolean).join(" - ")},R=(e,a,t)=>{let r=a.find(a=>a.type===e&&a.enabled);if(!r)return null;let n=r.content;return(n=(n=(n=(n=(n=(n=(n=n.replace("{cliente}",t.clientName)).replace("{servico}",t.services||"")).replace("{valor}",t.serviceValue||"")).replace("{data}",t.startTime.toLocaleDateString())).replace("{horario}",t.startTime.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))).replace("{barbeiro}",t.barberName||"")).replace("{barbearia}",t.barbershopName||"sua barbearia")).replace("{endereco}",t.barbershopAddress||"")};function L(e,a){return e>=a.start&&e<=a.end}function P(){let{barbershopId:e}=(0,I.Y)(),{toast:a}=(0,x.pm)(),{messageTemplates:t}=(0,_.l)(),[P,F]=(0,n.useState)({barbershop:null,barbers:[],services:[],clients:[],appointments:[]}),[Z,V]=(0,n.useState)(!0),[B,$]=(0,n.useState)(""),[q,W]=(0,n.useState)(!1),[Y,X]=(0,n.useState)(!1),[G,M]=(0,n.useState)(!1),[H,J]=(0,n.useState)(!1),[U,K]=(0,n.useState)(!1),[Q,ee]=(0,n.useState)(""),[ea,et]=(0,n.useState)(""),[er,en]=(0,n.useState)(""),[es,ei]=(0,n.useState)(null),[el,eo]=(0,n.useState)(null),[ed,ec]=(0,n.useState)(null),[eu,em]=(0,n.useState)(null),[ep,ef]=(0,n.useState)(""),[eh,ex]=(0,n.useState)(new Set),[ev,eg]=(0,n.useState)(void 0),[eb,ej]=(0,n.useState)(""),[ey,eN]=(0,n.useState)(""),[ew,eC]=(0,n.useState)([]),[eS,eA]=(0,n.useState)(!1);(0,n.useEffect)(()=>{(async()=>{if(e){V(!0);try{var t;let[a,r,n,s,i]=await Promise.all([(0,g.rd)("/api/barbershops?ownerId=".concat(encodeURIComponent(e))),(0,g.rd)("/api/barbers?barbershopId=".concat(encodeURIComponent(e))),(0,g.rd)("/api/services?barbershopId=".concat(encodeURIComponent(e))),(0,g.rd)("/api/clients?barbershopId=".concat(encodeURIComponent(e))),(0,g.rd)("/api/appointments?barbershopId=".concat(encodeURIComponent(e)))]);F({barbershop:(null===(t=a.data)||void 0===t?void 0:t[0])||null,barbers:r.data||[],services:n.data||[],clients:s.data||[],appointments:i.data||[]})}catch(e){a({variant:"destructive",title:"Erro",description:e.message||"Falha ao carregar dados."})}finally{V(!1)}}})()},[e,a]);let eI=(0,n.useMemo)(()=>{if(!ep)return P.services;let e=P.barbers.find(e=>e.id===ep);if(!e||!e.services)return[];let a=new Set(e.services.map(e=>e.serviceId));return P.services.filter(e=>a.has(e.id))},[ep,P.services,P.barbers]);(0,n.useEffect)(()=>{P.services&&eh.size>0?eN(String(P.services.filter(e=>eh.has(e.id)).reduce((e,a)=>e+a.duration,0))):eN("")},[eh,P.services]);let e_=e=>{let a=e.replace(/\D/g,"").replace(/^(\d{2})(\d)/,"($1) $2").replace(/(\d{5})(\d)/,"$1-$2");a.length>15&&(a=a.substring(0,15)),et(a)},ek=e=>e.replace(/\D/g,""),eD=e=>{let a=ek(e);return a.length>=10&&a.length<=11},eT=()=>{ee(""),et(""),en(""),ei(null),W(!1),X(!1)},eE=async e=>(await (0,g.rd)("/api/clients",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).data,ez=async(e,a)=>(await (0,g.rd)("/api/clients/".concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(a)})).data,eO=async e=>{await (0,g.rd)("/api/clients/".concat(e),{method:"DELETE"})},eR=async e=>(await (0,g.rd)("/api/appointments",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).data,eL=(0,n.useCallback)(async r=>{var n;if(!e)return;let s=E(r.clientPhone);if(s.length<10)return;let i=s.startsWith("55")?s:"55".concat(s),l=z(t,P.barbershop),o=r.services.reduce((e,a)=>e+a.price,0),d=R("Confirma\xe7\xe3o de Agendamento",l,{clientName:r.clientName,services:r.services.map(e=>e.name).join(", "),serviceValue:(0,v.xG)(o),barbershopAddress:O(P.barbershop),startTime:r.startTime,barberName:r.barberName,barbershopName:(null===(n=P.barbershop)||void 0===n?void 0:n.name)||"sua barbearia"});if(d)try{let a=await fetch("/api/bitsafira/message/send-message",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({barbershopId:e,number:i,message:d,envioImediato:1,clientName:r.clientName,messageType:"Confirma\xe7\xe3o de Agendamento"})}),t=await a.json();if(!a.ok||!(null==t?void 0:t.success))throw Error((null==t?void 0:t.message)||"Falha ao enviar confirma\xe7\xe3o autom\xe1tica.")}catch(e){a({variant:"destructive",title:"N\xe3o foi poss\xedvel enviar a confirma\xe7\xe3o autom\xe1tica",description:(null==e?void 0:e.message)||"Verifique a conex\xe3o do WhatsApp e tente novamente."})}},[e,P.barbershop,t,a]),eP=async()=>{if(!Q||!ea||!e){a({variant:"destructive",title:"Erro",description:"Preencha nome e WhatsApp."});return}let t=Q.trim();if(!/^[A-Za-zÁ-ÿ]/.test(t)){a({variant:"destructive",title:"Erro",description:"O nome deve come\xe7ar com uma letra."});return}if(!eD(ea)){a({variant:"destructive",title:"Erro",description:"Informe um WhatsApp v\xe1lido (DDD + n\xfamero)."});return}let r=!!es,n=ek(ea),s=t.toLowerCase();if(r&&es){if((P.clients||[]).filter(e=>e.id!==es.id&&ek(e.phone)===n).find(e=>e.name.trim().toLowerCase()===s)){a({variant:"destructive",title:"Erro",description:"J\xe1 existe um cliente com o mesmo nome e WhatsApp."});return}}else{let e=(P.clients||[]).filter(e=>ek(e.phone)===n);if(e.length>0){if(e.find(e=>e.name.trim().toLowerCase()===s)){a({variant:"destructive",title:"Erro",description:"J\xe1 existe um cliente com o mesmo nome e WhatsApp."});return}ec(e[0]),K(!0);return}}let i={name:(0,v.Ls)(Q),phone:ea,email:er||"",barbershopId:e};if(r&&es)try{let e=await ez(es.id,i);F(a=>({...a,clients:a.clients.map(a=>a.id===e.id?e:a)})),a({title:"Cliente Atualizado!",description:"Os dados de ".concat(i.name," foram salvos.")}),eT()}catch(e){a({variant:"destructive",title:"Erro",description:e.message||"Falha ao atualizar."})}else{let e=P.clients.find(e=>e.phone===ea);if(e){ec(e),K(!0);return}try{let e=await eE(i);F(a=>({...a,clients:[...a.clients,e]})),a({title:"Cliente Adicionado!",description:"".concat(i.name," foi adicionado.")}),eT(),K(!1)}catch(e){a({variant:"destructive",title:"Erro",description:e.message||"Falha ao criar cliente."})}}},eF=async()=>{if(!e)return;let t=ek(ea),r=Q.trim().toLowerCase();if((P.clients||[]).filter(e=>ek(e.phone)===t).find(e=>e.name.trim().toLowerCase()===r)){a({variant:"destructive",title:"Erro",description:"J\xe1 existe um cliente com o mesmo nome e WhatsApp."}),K(!1);return}if(!eD(ea)){a({variant:"destructive",title:"Erro",description:"Informe um WhatsApp v\xe1lido (DDD + n\xfamero)."});return}try{let t=await eE({barbershopId:e,name:(0,v.Ls)(Q),phone:ea,email:er||""});F(e=>({...e,clients:[...e.clients,t]})),a({title:"Cliente Adicionado!",description:"".concat(t.name," foi adicionado.")}),eT(),K(!1)}catch(e){a({variant:"destructive",title:"Erro",description:e.message||"Falha ao criar cliente."})}},eZ=e=>{ei(e),ee(e.name),et(e.phone),en(e.email||""),X(!0)},eV=e=>{eo(e),M(!0)},eB=async()=>{if(el)try{await eO(el.id),F(e=>({...e,clients:e.clients.filter(e=>e.id!==el.id)})),a({title:"Cliente Removido",description:"".concat(el.name," foi removido.")})}catch(e){a({variant:"destructive",title:"Erro",description:e.message||"Falha ao remover cliente."})}eo(null),M(!1)},e$=e=>"https://wa.me/55".concat(e.replace(/\D/g,"")),eq=()=>{em(null),ef(""),ex(new Set),eg(void 0),ej(""),eN(""),eC([])};(0,n.useEffect)(()=>{var e,a,t;if(!ep||!ev||!ey||!P.barbershop){eC([]);return}let r=parseInt(ey,10);if(Number.isNaN(r)||r<=0){eC([]);return}let n=P.barbers.find(e=>e.id===ep);if(!n){eC([]);return}eA(!0);let s=D[ev.getDay()],i=null===(e=n.schedule)||void 0===e?void 0:e.find(e=>e.day===s),l=null===(t=P.barbershop)||void 0===t?void 0:null===(a=t.operatingHours)||void 0===a?void 0:a.find(e=>e.day===s);if(!i||!l||"closed"===l.open.toLowerCase()){eC([]),eA(!1);return}let o=Math.max(T(l.open),T(i.start)),d=Math.min(T(l.close),T(i.end)),c=new Date(ev);c.setHours(0,0,0,0);let u=P.appointments.filter(e=>e.barberId===n.id&&(0,k.K)(new Date(e.startTime),ev)).map(e=>({start:new Date(e.startTime),end:new Date(e.endTime)})),m=[];for(let e=o;e+r<=d;e+=15){let a=new Date(c.getTime()+6e4*e),t=new Date(a.getTime()+6e4*r);u.some(e=>L(a,{start:e.start,end:e.end})||L(e.start,{start:a,end:t}))||m.push(a.toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"}))}eC(m),eA(!1)},[ep,ev,ey,P.appointments,P.barbers,P.barbershop]);let eW=async()=>{if(!eu||!ep||0===eh.size||!ev||!eb||!e){a({variant:"destructive",title:"Erro",description:"Preencha todos os campos do agendamento."});return}let t=parseInt(ey,10)||0,[r,n]=eb.split(":").map(Number),s=new Date(ev);s.setHours(r,n,0,0);let i=new Date(s.getTime()+6e4*t);try{var l;let r=await eR({barbershopId:e,clientId:eu.id,clientName:eu.name,clientPhone:eu.phone,barberId:ep,serviceIds:Array.from(eh),startTime:s.toISOString(),endTime:i.toISOString(),status:"confirmed",totalDuration:t});F(e=>({...e,appointments:[...e.appointments,r]}));let n=P.services.filter(e=>eh.has(e.id)),o=(null===(l=P.barbers.find(e=>e.id===ep))||void 0===l?void 0:l.name)||"Barbeiro";await eL({clientName:eu.name,clientPhone:eu.phone,services:n,startTime:s,barberName:o}),a({title:"Agendamento Criado!",description:"Agendamento para ".concat(eu.name," confirmado.")}),J(!1),eq()}catch(e){a({variant:"destructive",title:"Erro",description:e.message||"Falha ao criar agendamento."})}},eY=(0,n.useMemo)(()=>{if(!P.clients)return[];if(!B)return P.clients;let e=B.toLowerCase();return P.clients.filter(a=>a.name.toLowerCase().includes(e)||a.phone.replace(/\D/g,"").includes(e.replace(/\D/g,"")))},[P.clients,B]);return(0,r.jsxs)("div",{className:"space-y-6",children:[(0,r.jsxs)("div",{className:"flex items-center justify-between",children:[(0,r.jsx)("h1",{className:"text-3xl font-bold font-headline",children:"Clientes"}),(0,r.jsxs)(o.Vq,{open:q,onOpenChange:e=>{e||eT(),W(e)},children:[(0,r.jsx)(o.hg,{asChild:!0,children:(0,r.jsxs)(i.z,{size:"sm",className:"gap-1 transition-transform duration-300 hover:scale-105 hover:shadow-lg",children:[(0,r.jsx)(j.Z,{className:"h-4 w-4"}),"Adicionar Cliente"]})}),(0,r.jsxs)(o.cZ,{className:"sm:max-w-md",children:[(0,r.jsxs)(o.fK,{children:[(0,r.jsx)(o.$N,{children:"Adicionar Novo Cliente"}),(0,r.jsx)(o.Be,{children:"Preencha os dados abaixo."})]}),(0,r.jsxs)("div",{className:"space-y-4 py-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{htmlFor:"add-client-name",children:"Nome *"}),(0,r.jsx)(c.I,{id:"add-client-name",value:Q,onChange:e=>ee(e.target.value),placeholder:"Nome completo"})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{htmlFor:"add-client-phone",children:"WhatsApp *"}),(0,r.jsx)(c.I,{id:"add-client-phone",value:ea,onChange:e=>e_(e.target.value),placeholder:"(XX) 9XXXX-XXXX",maxLength:15})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{htmlFor:"add-client-email",children:"Email (Opcional)"}),(0,r.jsx)(c.I,{id:"add-client-email",type:"email",value:er,onChange:e=>en(e.target.value),placeholder:"email@exemplo.com"})]})]}),(0,r.jsxs)(o.cN,{children:[(0,r.jsx)(o.GG,{asChild:!0,children:(0,r.jsx)(i.z,{variant:"outline",children:"Fechar"})}),(0,r.jsx)(i.z,{onClick:eP,children:"Salvar Cliente"})]})]})]})]}),(0,r.jsxs)(l.Zb,{children:[(0,r.jsxs)(l.Ol,{children:[(0,r.jsx)(l.ll,{children:"Sua Lista de Clientes"}),(0,r.jsx)(l.SZ,{children:"Gerencie as informa\xe7\xf5es dos seus clientes."}),(0,r.jsxs)("div",{className:"relative pt-2",children:[(0,r.jsx)(y.Z,{className:"absolute left-3 top-1/2 -translate-y-1/2 h-4 w-4 text-muted-foreground"}),(0,r.jsx)(c.I,{placeholder:"Buscar por nome ou telefone...",className:"pl-10",value:B,autoComplete:"off",spellCheck:!1,onChange:e=>$(e.target.value)})]})]}),(0,r.jsx)(l.aY,{children:Z?(0,r.jsx)("div",{className:"flex justify-center items-center py-16",children:(0,r.jsx)(N.Z,{className:"h-8 w-8 animate-spin text-muted-foreground"})}):eY&&eY.length>0?(0,r.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:eY.map(e=>(0,r.jsxs)(l.Zb,{className:"flex flex-col",children:[(0,r.jsxs)(l.Ol,{className:"flex flex-row items-center gap-4",children:[(0,r.jsxs)(m.Avatar,{className:"h-12 w-12",children:[(0,r.jsx)(m.AvatarImage,{src:"https://picsum.photos/seed/".concat(e.id,"/128/128"),alt:e.name,"data-ai-hint":"person portrait"}),(0,r.jsx)(m.AvatarFallback,{children:e.name.charAt(0)})]}),(0,r.jsxs)("div",{className:"flex-1",children:[(0,r.jsx)(l.ll,{className:"text-base",children:e.name}),e.email&&(0,r.jsxs)(l.SZ,{className:"flex items-center gap-1 text-xs",children:[(0,r.jsx)(w.Z,{className:"h-3 w-3"}),e.email]})]})]}),(0,r.jsx)(l.aY,{className:"flex-1",children:(0,r.jsx)("p",{className:"text-muted-foreground",children:e.phone})}),(0,r.jsxs)(l.eW,{className:"grid grid-cols-3 gap-2 p-2 bg-muted/50",children:[(0,r.jsx)(i.z,{variant:"outline",size:"sm",asChild:!0,className:"text-green-500 border-green-500 hover:bg-green-500/10 hover:text-green-500",children:(0,r.jsx)(s.default,{href:e$(e.phone),target:"_blank",children:(0,r.jsx)(b.y,{className:"h-4 w-4"})})}),(0,r.jsx)(i.z,{variant:"outline",size:"sm",onClick:()=>eZ(e),className:"text-primary hover:text-primary",children:(0,r.jsx)(C.Z,{className:"h-4 w-4"})}),(0,r.jsx)(i.z,{variant:"destructive",size:"sm",onClick:()=>eV(e),children:(0,r.jsx)(S.Z,{className:"h-4 w-4"})})]})]},e.id))}):(0,r.jsx)("div",{className:"text-center text-muted-foreground py-16",children:(0,r.jsx)("p",{children:"Nenhum cliente encontrado."})})})]}),(0,r.jsx)(o.Vq,{open:Y,onOpenChange:e=>{e||eT(),X(e)},children:(0,r.jsxs)(o.cZ,{className:"sm:max-w-md",children:[(0,r.jsxs)(o.fK,{children:[(0,r.jsx)(o.$N,{children:"Editar Cliente"}),(0,r.jsx)(o.Be,{children:"Altere os dados do cliente."})]}),(0,r.jsxs)("div",{className:"space-y-4 py-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{htmlFor:"edit-client-name",children:"Nome"}),(0,r.jsx)(c.I,{id:"edit-client-name",value:Q,onChange:e=>ee(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{htmlFor:"edit-client-phone",children:"WhatsApp"}),(0,r.jsx)(c.I,{id:"edit-client-phone",value:ea,onChange:e=>e_(e.target.value),maxLength:15})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{htmlFor:"edit-client-email",children:"Email"}),(0,r.jsx)(c.I,{id:"edit-client-email",type:"email",value:er,onChange:e=>en(e.target.value)})]})]}),(0,r.jsxs)(o.cN,{children:[(0,r.jsx)(o.GG,{asChild:!0,children:(0,r.jsx)(i.z,{variant:"outline",children:"Cancelar"})}),(0,r.jsx)(i.z,{onClick:eP,children:"Salvar Altera\xe7\xf5es"})]})]})}),(0,r.jsx)(d.aR,{open:G,onOpenChange:M,children:(0,r.jsxs)(d._T,{children:[(0,r.jsxs)(d.fY,{children:[(0,r.jsx)(d.f$,{children:"Remover cliente?"}),(0,r.jsxs)(d.yT,{children:["Isto remover\xe1 ",(0,r.jsx)("span",{className:"font-bold",children:null==el?void 0:el.name})," da sua lista."]})]}),(0,r.jsxs)(d.xo,{children:[(0,r.jsx)(d.le,{children:"Cancelar"}),(0,r.jsx)(d.OL,{onClick:eB,className:"bg-destructive hover:bg-destructive/90",children:"Remover da Lista"})]})]})}),(0,r.jsx)(d.aR,{open:U,onOpenChange:K,children:(0,r.jsxs)(d._T,{children:[(0,r.jsxs)(d.fY,{children:[(0,r.jsxs)(d.f$,{className:"flex items-center gap-2",children:[(0,r.jsx)(A.Z,{className:"text-amber-500 h-6 w-6"}),"N\xfamero de WhatsApp Duplicado"]}),(0,r.jsxs)(d.yT,{children:["J\xe1 existe um cliente chamado ",(0,r.jsx)("span",{className:"font-bold",children:null==ed?void 0:ed.name})," com este n\xfamero. Deseja cadastrar mesmo assim?"]})]}),(0,r.jsxs)(d.xo,{children:[(0,r.jsx)(d.le,{onClick:()=>K(!1),children:"Cancelar"}),(0,r.jsx)(d.OL,{onClick:eF,children:"Sim, Cadastrar"})]})]})}),(0,r.jsx)(o.Vq,{open:H,onOpenChange:J,children:(0,r.jsxs)(o.cZ,{className:"sm:max-w-lg",children:[(0,r.jsx)(o.fK,{children:(0,r.jsxs)(o.$N,{children:["Novo Agendamento para ",null==eu?void 0:eu.name]})}),(0,r.jsxs)("div",{className:"space-y-4 py-4 max-h-[70vh] overflow-y-auto pr-2",children:[(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{children:"Barbeiro *"}),(0,r.jsxs)(p.Ph,{value:ep,onValueChange:ef,children:[(0,r.jsx)(p.i4,{children:(0,r.jsx)(p.ki,{placeholder:"Selecione o barbeiro"})}),(0,r.jsx)(p.Bw,{children:P.barbers.map(e=>(0,r.jsx)(p.Ql,{value:e.id,children:e.name},e.id))})]})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{children:"Servi\xe7os *"}),(0,r.jsx)("div",{className:"space-y-2 rounded-md border p-4 max-h-40 overflow-y-auto",children:eI.map(e=>(0,r.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,r.jsx)(f.X,{id:"service-".concat(e.id),checked:eh.has(e.id),onCheckedChange:a=>ex(t=>{let r=new Set(t);return a?r.add(e.id):r.delete(e.id),r})}),(0,r.jsxs)(u._,{htmlFor:"service-".concat(e.id),className:"flex justify-between w-full cursor-pointer",children:[(0,r.jsx)("span",{children:e.name}),(0,r.jsx)("span",{className:"text-muted-foreground",children:(0,v.xG)(e.price)})]})]},e.id))})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{children:"Dura\xe7\xe3o Total (minutos)"}),(0,r.jsx)(c.I,{type:"number",value:ey,onChange:e=>eN(e.target.value)})]}),(0,r.jsxs)("div",{className:"space-y-2",children:[(0,r.jsx)(u._,{children:"Data & Hor\xe1rio *"}),(0,r.jsxs)("div",{className:"flex flex-col md:flex-row gap-4",children:[(0,r.jsx)(h.f,{mode:"single",selected:ev,onSelect:eg,className:"rounded-md border"}),(0,r.jsx)("div",{className:"grid grid-cols-3 gap-2 w-full max-h-60 overflow-y-auto",children:eS?(0,r.jsx)("p",{className:"col-span-3 text-center",children:"Carregando..."}):ew.length>0?ew.map(e=>(0,r.jsx)(i.z,{variant:eb===e?"default":"outline",onClick:()=>ej(e),children:e},e)):(0,r.jsx)("p",{className:"col-span-3 text-center",children:"Nenhum hor\xe1rio dispon\xedvel."})})]})]})]}),(0,r.jsxs)(o.cN,{children:[(0,r.jsx)(o.GG,{asChild:!0,children:(0,r.jsx)(i.z,{variant:"outline",children:"Cancelar"})}),(0,r.jsx)(i.z,{onClick:eW,children:"Confirmar Agendamento"})]})]})})]})}},41354:function(e,a,t){"use strict";t.d(a,{y:function(){return n}});var r=t(57437);function n(e){return(0,r.jsx)("svg",{xmlns:"http://www.w3.org/2000/svg",width:"24",height:"24",viewBox:"0 0 16 16",fill:"currentColor",...e,children:(0,r.jsx)("path",{d:"M13.601 2.326A7.85 7.85 0 0 0 7.994 0C3.627 0 .068 3.558.064 7.926c0 1.399.366 2.76 1.057 3.965L0 16l4.204-1.102a7.9 7.9 0 0 0 3.79.965h.004c4.368 0 7.926-3.558 7.93-7.93A7.89 7.89 0 0 0 13.6 2.326zM7.994 14.521a6.57 6.57 0 0 1-3.356-.92l-.24-.144-2.494.654.666-2.433-.156-.251a6.56 6.56 0 0 1-1.007-3.505c0-3.626 2.957-6.584 6.591-6.584a6.56 6.56 0 0 1 4.66 1.931 6.56 6.56 0 0 1 1.928 4.66c-.004 3.639-2.961 6.592-6.592 6.592m3.615-4.934c-.197-.099-1.17-.578-1.353-.646-.182-.065-.315-.099-.445.099-.133.197-.513.646-.627.775-.114.133-.232.148-.43.05-.197-.1-.836-.308-1.592-.985-.59-.525-.985-1.175-1.103-1.372-.114-.198-.011-.304.088-.403.087-.088.197-.232.296-.346.1-.114.133-.198.198-.33.065-.134.034-.248-.015-.347-.05-.1-.445-1.076-.612-1.47-.16-.389-.323-.335-.445-.34-.114-.007-.247-.007-.38-.007a.73.73 0 0 0-.529.247c-.182.198-.691.677-.691 1.654s.71 1.916.81 2.049c.098.133 1.394 2.132 3.383 2.992.47.205.84.326 1.129.418.475.152.904.129 1.246.08.38-.058 1.171-.48 1.338-.943.164-.464.164-.86.114-.943-.049-.084-.182-.133-.38-.232"})})}},30767:function(e,a,t){"use strict";t.d(a,{OL:function(){return x},_T:function(){return u},aR:function(){return o},f$:function(){return f},fY:function(){return m},le:function(){return v},xo:function(){return p},yT:function(){return h}});var r=t(57437),n=t(2265),s=t(7880),i=t(93448),l=t(12381);let o=s.fC;s.xz;let d=s.h_,c=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.aV,{className:(0,i.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n,ref:a})});c.displayName=s.aV.displayName;let u=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsxs)(d,{children:[(0,r.jsx)(c,{}),(0,r.jsx)(s.VY,{ref:a,className:(0,i.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...n})]})});u.displayName=s.VY.displayName;let m=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col space-y-2 text-center sm:text-left",a),...t})};m.displayName="AlertDialogHeader";let p=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,i.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};p.displayName="AlertDialogFooter";let f=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.Dx,{ref:a,className:(0,i.cn)("text-lg font-semibold",t),...n})});f.displayName=s.Dx.displayName;let h=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.dk,{ref:a,className:(0,i.cn)("text-sm text-muted-foreground",t),...n})});h.displayName=s.dk.displayName;let x=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.aU,{ref:a,className:(0,i.cn)((0,l.d)(),t),...n})});x.displayName=s.aU.displayName;let v=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.$j,{ref:a,className:(0,i.cn)((0,l.d)({variant:"outline"}),"mt-2 sm:mt-0",t),...n})});v.displayName=s.$j.displayName},96246:function(e,a,t){"use strict";t.d(a,{Avatar:function(){return l},AvatarFallback:function(){return d},AvatarImage:function(){return o}});var r=t(57437),n=t(2265),s=t(70650),i=t(93448);let l=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.fC,{ref:a,className:(0,i.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...n})});l.displayName=s.fC.displayName;let o=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.Ee,{ref:a,className:(0,i.cn)("aspect-square h-full w-full",t),...n})});o.displayName=s.Ee.displayName;let d=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.NY,{ref:a,className:(0,i.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...n})});d.displayName=s.NY.displayName},46291:function(e,a,t){"use strict";t.d(a,{f:function(){return p}});var r=t(57437),n=t(2265),s=t(82521),i=t(76848),l=t(19181),o=t(34862),d=t(93448),c=t(12381),u=t(15291),m=t(90641);function p(e){let{className:a,classNames:t,showOutsideDays:p=!0,...f}=e;return(0,r.jsx)(l._W,{locale:o.F,showOutsideDays:p,className:(0,d.cn)("p-3",a),classNames:{months:"flex flex-col sm:flex-row space-y-4 sm:space-x-4 sm:space-y-0",month:"space-y-4",caption:"flex justify-center pt-1 relative items-center",caption_label:"text-sm font-medium",caption_dropdowns:"flex justify-center gap-2",nav:"space-x-1 flex items-center",nav_button:(0,d.cn)((0,c.d)({variant:"outline"}),"h-7 w-7 bg-transparent p-0 opacity-50 hover:opacity-100"),nav_button_previous:"absolute left-1",nav_button_next:"absolute right-1",table:"w-full border-collapse space-y-1",head_row:"flex",head_cell:"text-muted-foreground rounded-md w-9 font-normal text-[0.8rem]",row:"flex w-full mt-2",cell:"h-9 w-9 text-center text-sm p-0 relative [&:has([aria-selected].day-range-end)]:rounded-r-md [&:has([aria-selected].day-outside)]:bg-accent/50 [&:has([aria-selected])]:bg-accent first:[&:has([aria-selected])]:rounded-l-md last:[&:has([aria-selected])]:rounded-r-md focus-within:relative focus-within:z-20",day:(0,d.cn)((0,c.d)({variant:"ghost"}),"h-9 w-9 p-0 font-normal aria-selected:opacity-100"),day_range_end:"day-range-end",day_selected:"bg-primary text-primary-foreground hover:bg-primary hover:text-primary-foreground focus:bg-primary focus:text-primary-foreground",day_today:"text-primary font-semibold",day_outside:"day-outside text-muted-foreground opacity-50 aria-selected:bg-accent/50 aria-selected:text-muted-foreground aria-selected:opacity-30",day_disabled:"text-muted-foreground opacity-50",day_range_middle:"aria-selected:bg-accent aria-selected:text-accent-foreground",day_hidden:"invisible",...t},components:{IconLeft:e=>{let{className:a,...t}=e;return(0,r.jsx)(s.Z,{className:(0,d.cn)("h-4 w-4",a),...t})},IconRight:e=>{let{className:a,...t}=e;return(0,r.jsx)(i.Z,{className:(0,d.cn)("h-4 w-4",a),...t})},Dropdown:e=>{var a;let{value:t,onChange:s,children:i,...l}=e,o=n.Children.toArray(i),d=o.find(e=>e.props.value===t),c=e=>{null==s||s({target:{value:e}})};return(0,r.jsxs)(u.Ph,{value:null==t?void 0:t.toString(),onValueChange:e=>{c(e)},children:[(0,r.jsx)(u.i4,{className:"pr-1.5 focus:ring-0 w-auto",children:(0,r.jsx)(u.ki,{children:null==d?void 0:null===(a=d.props)||void 0===a?void 0:a.children})}),(0,r.jsx)(u.Bw,{position:"popper",children:(0,r.jsx)(m.x,{className:"h-80",children:o.map((e,a)=>{var t,n;return(0,r.jsx)(u.Ql,{value:null!==(n=null===(t=e.props.value)||void 0===t?void 0:t.toString())&&void 0!==n?n:"",children:e.props.children},"".concat(e.props.value,"-").concat(a))})})})]})}},...f})}p.displayName="Calendar"},68245:function(e,a,t){"use strict";t.d(a,{X:function(){return o}});var r=t(57437),n=t(2265),s=t(9270),i=t(59559),l=t(93448);let o=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.fC,{ref:a,className:(0,l.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",t),...n,children:(0,r.jsx)(s.z$,{className:(0,l.cn)("flex items-center justify-center text-current"),children:(0,r.jsx)(i.Z,{className:"h-4 w-4"})})})});o.displayName=s.fC.displayName},74291:function(e,a,t){"use strict";t.d(a,{$N:function(){return x},Be:function(){return v},GG:function(){return u},Vq:function(){return o},cN:function(){return h},cZ:function(){return p},fK:function(){return f},hg:function(){return d}});var r=t(57437),n=t(2265),s=t(70001),i=t(44986),l=t(93448);let o=s.fC,d=s.xz,c=s.h_,u=s.x8,m=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.aV,{ref:a,className:(0,l.cn)("fixed inset-0 z-50 bg-black/80 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",t),...n})});m.displayName=s.aV.displayName;let p=n.forwardRef((e,a)=>{let{className:t,children:n,...o}=e;return(0,r.jsxs)(c,{children:[(0,r.jsx)(m,{}),(0,r.jsxs)(s.VY,{ref:a,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",t),...o,children:[n,(0,r.jsxs)(s.x8,{className:"absolute right-4 top-4 rounded-sm opacity-70 ring-offset-background transition-opacity hover:opacity-100 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none data-[state=open]:bg-accent data-[state=open]:text-muted-foreground",children:[(0,r.jsx)(i.Z,{className:"h-4 w-4"}),(0,r.jsx)("span",{className:"sr-only",children:"Close"})]})]})]})});p.displayName=s.VY.displayName;let f=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-1.5 text-center sm:text-left",a),...t})};f.displayName="DialogHeader";let h=e=>{let{className:a,...t}=e;return(0,r.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",a),...t})};h.displayName="DialogFooter";let x=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.Dx,{ref:a,className:(0,l.cn)("text-lg font-semibold leading-none tracking-tight",t),...n})});x.displayName=s.Dx.displayName;let v=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.dk,{ref:a,className:(0,l.cn)("text-sm text-muted-foreground",t),...n})});v.displayName=s.dk.displayName},40279:function(e,a,t){"use strict";t.d(a,{I:function(){return i}});var r=t(57437),n=t(2265),s=t(93448);let i=n.forwardRef((e,a)=>{let{className:t,type:n,...i}=e;return(0,r.jsx)("input",{type:n,className:(0,s.cn)("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",t),ref:a,...i})});i.displayName="Input"},75060:function(e,a,t){"use strict";t.d(a,{_:function(){return d}});var r=t(57437),n=t(2265),s=t(6394),i=t(90535),l=t(93448);let o=(0,i.j)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=n.forwardRef((e,a)=>{let{className:t,...n}=e;return(0,r.jsx)(s.f,{ref:a,className:(0,l.cn)(o(),t),...n})});d.displayName=s.f.displayName},26811:function(e,a,t){"use strict";t.d(a,{N:function(){return o},Y:function(){return d}});var r=t(57437),n=t(71245),s=t(94076),i=t(2265);let l=(0,i.createContext)(void 0);function o(e){let{children:a}=e,{user:t,isLoading:o}=(0,n.a)(),[d,c]=(0,i.useState)(null),[u,m]=(0,i.useState)(!0);return(0,i.useEffect)(()=>{let e=!0,a=null;return o?(m(!0),()=>{e=!1}):t?((async()=>{m(!0),a=new AbortController;try{var r,n,i,l,o,d;let u=await (0,s.rd)("/api/barbershops?ownerId=".concat(encodeURIComponent(t.id)),{signal:a.signal});if(!e)return;let m=null!==(o=null===(n=u.data)||void 0===n?void 0:null===(r=n[0])||void 0===r?void 0:r.id)&&void 0!==o?o:null;if(m){c(m);return}let p=await (0,s.rd)("/api/barbershops",{signal:a.signal});if(!e)return;c(null!==(d=null===(l=p.data)||void 0===l?void 0:null===(i=l[0])||void 0===i?void 0:i.id)&&void 0!==d?d:null)}catch(a){if(!e)return;(null==a?void 0:a.name)!=="AbortError"&&(console.warn("Falha ao buscar barbearia (owner e fallback):",a),c(null))}finally{if(!e)return;m(!1)}})(),()=>{e=!1,null==a||a.abort()}):(c(null),m(!1),()=>{e=!1})},[t,o]),(0,r.jsx)(l.Provider,{value:{barbershopId:d,isLoading:u},children:a})}function d(){let e=(0,i.useContext)(l);if(void 0===e)throw Error("useBarbershopId must be used within a BarbershopIdProvider");return e}},58203:function(e,a,t){"use strict";t.d(a,{l:function(){return o},o:function(){return l}});var r=t(57437),n=t(2265),s=t(46586);let i=(0,n.createContext)(void 0);function l(e){let{children:a}=e,[t,l]=(0,n.useState)(s.pe);return(0,r.jsx)(i.Provider,{value:{messageTemplates:t,setMessageTemplates:l},children:a})}function o(){let e=(0,n.useContext)(i);if(void 0===e)throw Error("useMessageTemplates must be used within a MessageTemplatesProvider");return e}},46586:function(e,a,t){"use strict";t.d(a,{pe:function(){return r}}),new Date().getTime();let r=[{id:"tmpl1",name:"Lembrete Padr\xe3o",type:"Lembrete de Agendamento",content:"Ol\xe1, {cliente}!\nPassando para lembrar do seu hor\xe1rio amanh\xe3 \xe0s {horario} com {barbeiro}.\nAt\xe9 l\xe1!\nEquipe {barbearia}.",enabled:!0,reminderHoursBefore:24},{id:"tmpl2",name:"Confirma\xe7\xe3o Padr\xe3o",type:"Confirma\xe7\xe3o de Agendamento",content:"Ol\xe1, {cliente}!\nSeu agendamento para {servico} no dia {data} \xe0s {horario} foi confirmado.\nEquipe {barbearia}.",enabled:!0},{id:"tmpl4",name:"Confirma\xe7\xe3o Manual",type:"Confirma\xe7\xe3o Manual",content:"Ol\xe1, {cliente}!\nPassando para confirmar seu agendamento para {servico} no dia {data} \xe0s {horario} com {barbeiro}.\nPor favor, responda 'SIM' para confirmar.\nEquipe {barbearia}.",enabled:!0},{id:"tmpl3",name:"Pesquisa Padr\xe3o",type:"Pesquisa de Satisfa\xe7\xe3o",content:"Ol\xe1, {cliente}!\nAgradecemos a sua visita.\nO que voc\xea achou do nosso servi\xe7o?\nResponda de 0 a 10.\nEquipe {barbearia}.",enabled:!1}]}},function(e){e.O(0,[6137,1906,9049,7347,8888,6008,2550,8642,926,2915,5918,4744,2971,2117,1744],function(){return e(e.s=88028)}),_N_E=e.O()}]);